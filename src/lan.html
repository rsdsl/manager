<!doctype html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="styles.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LAN - RSDSL Verwaltungswerkzeug</title>
    <script type="module" src="/dashboard.js" defer></script>
    <script type="module" src="/lan.js" defer></script>
  </head>

  <body>
    <div class="container">
      <h1>LAN</h1>

      <div class="row">
        <form id="dashboard-form">
          <button id="dashboard-submit" type="submit">‚Ü© Zur√ºck zur √úbersicht</button>
        </form>

        <form id="wan-open-form">
          <button id="wan-open-submit" type="submit">Einwahl und Zugansdaten</button>
        </form>

        <form id="lan-open-form">
          <button id="lan-open-submit" type="submit">LAN</button>
        </form>

        <form id="ddns-open-form">
          <button id="ddns-open-submit" type="submit">Dynamisches DNS (INWX)</button>
        </form>

        <form id="log-open-form">
          <button id="log-open-submit" type="submit">Diagnoseprotokolle</button>
        </form>

        <form id="sys-open-form">
          <button id="sys-open-submit" type="submit">Systemeinstellungen</button>
        </form>

        <form id="disconnect-form">
          <button id="disconnect-submit" type="submit">üö™ Abmelden</button>
        </form>
      </div>

      <br />

      <form id="vlan-form">
        <fieldset>
          <legend>Virtuelle Netzwerke</legend>

          <p>Zur Erh√∂hung der Sicherheit ist dieses Netzwerk in mehrere
          virtuelle Subnetze unterteilt. Bei richtiger Verteilung neuer Ger√§te
          auf diese Netzwerke wird die Sicherheit der Kernnetze erheblich
          gesteigert. Die folgende Tabelle listet alle Subnetze auf und
          beschreibt ihre technischen Informationen und Zwecke.</p>

          <table>
            <th>
              <td>WLAN-Name (SSID)</td>
              <td>VLAN ID</td>
              <td>Subnetznummer (IPv4)</td>
              <td>Subnetznummer (IPv6, hexadezimal)</td>
              <td>Beschreibung</td>
            </th>

            <tr>
              <td>Management</td>
              <td>- (nur kabelgebunden)</td>
              <td>Kein VLAN</td>
              <td>0</td>
              <td>1</td>
              <td>Verwaltungsnetz f√ºr Access Points, Switch und Telefonadapter.
              Voller Internet- und Verwaltungszugriff. Nur f√ºr genannte Ger√§te
              oder vor√ºbergehende Diagnosearbeiten bestimmt. √úber dieses
              Netzwerk tauschen sich Access Points und Switch mit dem
              Konfigurationsserver im lokalen Netz aus.</td>
            </tr>

            <tr>
              <td>Trusted</td>
              <td>WLAN-Kabel</td>
              <td>10</td>
              <td>10</td>
              <td>2</td>
              <td>Kernnetz f√ºr vertrauensw√ºrdige Ger√§te. Voller Internet- und
              Verwaltungszugriff. Nur f√ºr Computer, Tablets und Smartphones von
              Familienmitgliedern.</td>
            </tr>

            <tr>
              <td>Untrusted</td>
              <td>Internet</td>
              <td>20</td>
              <td>20</td>
              <td>3</td>
              <td>Netz f√ºr G√§ste und internetgebundene IoT-Ger√§te. Nur f√ºr
              solche Ger√§te bestimmt, die eine Internetverbindung f√ºr ihre
              Kernfunktionalit√§t zwingend ben√∂tigen (ausgenommen Computer,
              Tablets und Smartphones von G√§sten). Keine Kommunikation zwischen
              diesem Netzwerk und dem Kernnetz m√∂glich, aber voller
              Internetzugriff. Kein Verwaltungszugriff auf wichtige
              Netzwerkger√§te, auch nicht mit korrekten Zugangsdaten.</td>
            </tr>

            <tr>
              <td>Isolated</td>
              <td>Schwefelhexafluorid</td>
              <td>30</td>
              <td>30</td>
              <td>4</td>
              <td>Abgeschottetes Netz f√ºr IoT-Ger√§te ohne Internetzwang (z.B.
              Drucker). Keine Kommunikation zur Au√üenwelt m√∂glich (auch nicht
              zu anderen lokalen Netzen). Kein Verwaltungszugriff auf wichtige
              Netzwerkger√§te. Ger√§te in diesem Netz erhalten IP-Adressen nach
              dem gleichen Muster wie in den anderen Netzwerken, k√∂nnen aber
              selbst mit den √∂ffentlichen IPv6-Adressen die Firewall nicht
              passieren. Verbindungen der Ger√§te untereinander sind erlaubt. Um
              mit hier untergebrachten Ger√§ten zu kommunizieren, muss der
              eigene Rechner vor√ºbergehend selbst mit diesem Netzwerk verbunden
              werden.</td>
            </tr>

            <tr>
              <td>Exposed</td>
              <td>Neuland</td>
              <td>40</td>
              <td>40</td>
              <td>5</td>
              <td>Servernetz. Keine Kommunikation zu Ger√§tenetzen m√∂glich, aber
              Ger√§tenetze d√ºrfen Verbindungen zu Servern in diesem Netzwerk
              aufbauen. Voller Internetzugriff, aber kein Verwaltungszugriff
              auf wichtige Netzwerkger√§te. Enth√§lt den Hauptserver und
              Telefonadapter. Die Router-Firewall sch√ºtzt Ger√§te in diesem
              Netzwerk nicht und l√§sst Verbindungsanfragen aus dem √∂ffentlichen
              Internet zu. Aufgrund von NAT ist nur Telefonie √ºber IPv4
              freigegeben, alle anderen Dienste sind trotz Firewallausnahme nur
              √ºber IPv6 erreichbar. Gleiches gilt f√ºr tempor√§re Server auf
              gew√∂hnlichen Computern, die vor√ºbergehend mit diesem Netzwerk
              verbunden werden. Da die √∂ffentliche IPv4-Adresse sp√§testens bei
              einem Anbieterwechsel mit gro√üer Wahrscheinlichkeit verschwinden
              wird, sind bereits jetzt nur IPv6-Freigaben m√∂glich. Dieses
              Netzwerk wird von Servern verwendet, um bei Kompromittierung die
              anderen Ger√§te nicht zu gef√§hrden. Es kann aber auch von
              gew√∂hnlichen Rechnern genutzt werden, wenn die Freigabe einer
              Software f√ºr das √∂ffentliche Internet n√∂tig ist.</td>
            </tr>
          </table>

          <p>Information: Die privaten IPv4-Adressen folgen der Form
          10.128.<i>IPv4-Subnetznummer</i>.X, wobei X eine ger√§tespezifische
          Zahl zwischen 1 und (einschlie√ülich) 254 ist. Die √∂ffentlichen
          IPv6-Adressen werden zugewiesen, indem die IPv6-Subnetznummer an das
          vom Internetanbieter zugewiesene Pr√§fix angeh√§ngt wird (optimal ist
          eine Pr√§fixl√§nge von /56, die kleinste unterst√ºtzte Pr√§fixl√§nge ist
          /61) und den Ger√§ten die Wahl der zweiten Adressh√§lfte √ºberlassen
          wird. Der Router w√§hlt stets ::1 als eigene zweite Adressh√§lfte. Die
          verbindungslokalen IPv6-Adressen werden von den einzelnen Ger√§ten
          selbst verwaltet, der Router nutzt in jedem Netzwerk (au√üer der
          Internetverbindung nach au√üen) fe80::1.</p>
        </fieldset>
      </form>

      <br />

      <form id="dhcpv4-form">
        <fieldset>
          <legend>DHCPv4-Server</legend>

          <span class="row" id="dhcpv4-starthostid">Startadresse der dynamischen Vergabe (nur letztes Oktett): 100</span>
          <span class="row" id="dhcpv4-endhostid"></span>Endadresse (inkl.) der dynamischen Vergabe (nur letztes Oktett): 239</span>
          <span class="row" id="dhcpv4-self">Routeradresse (nur letztes Oktett): 254</span>
          <span class="row" id="dhcpv4-netmask">Subnetzmaske: 255.255.255.0 (CIDR: /24)</span>
          <span class="row" id="dhcpv4-leasetime">G√ºltigkeitsdauer dynamisch vergebener Adressen: 12 Stunden (43200 Sekunden)</span>

          <p>Information: Wichtige Netzwerkger√§te sind statisch mit Adressen
          mit letztem Oktett 240 und aufw√§rts konfiguriert. Normale Ger√§te, die
          eine statische bzw. manuelle Adressvergabe ben√∂tigen, sollten
          Adressen mit letztem Oktett echt kleiner als 100 verwenden.</p>

          <p>Information: Dynamisch vergebene Adressen bleiben in der Regel
          auch nach Ablauf der G√ºltigkeitsdauer konstant, d.h. beim n√§chsten
          Verbindungsaufbau des entsprechenden Ger√§tes wird wieder die gleiche
          Adresse zugewiesen. Hierzu wird ein Verfahren verwendet, welches die
          IP-Adresse aus der Hardwareadresse berechnet. Ausnahmen k√∂nnen
          entstehen, wenn der Zuweisungsalgorithmus eine Kollision erkennt,
          also wenn mehrere Ger√§te die gleiche IP-Adresse zugewiesen bekommen
          w√ºrden. In derartigen F√§llen wird eine alternative Adresse gesucht
          und zugewiesen. Werden nun beide Ger√§te f√ºr die restliche
          G√ºltigkeitsdauer vom Netzwerk getrennt und danach in umgekehrter
          Reihenfolge wieder verbunden, werden ihre IP-Adressen vertauscht.
          Dies hat keine Auswirkung auf die Internetverbindung und bedeutet
          lediglich, dass nicht garantiert ist, dass der DHCP-Server jedem
          Ger√§t stets die gleiche Adresse zuweist (Standardverhalten aller
          g√§ngigen Implementationen). Werden feste Adressen ben√∂tigt, so m√ºssen
          diese direkt auf den jeweiligen Ger√§ten eingetragen und DHCP in deren
          Einstellungen deaktiviert werden.</p>

          <fieldset>
            <legend>Wichtige, statisch konfigurierte Netzwerkger√§te (nicht per DHCP verwaltet)</legend>

            <span class="row">192.168.1.1/24: DSL-Modem</span>
            <span class="row">10.128.0.248/24: Switch</span>
            <span class="row">10.128.0.249/24: Access Point im Dachgeschoss</span>
            <span class="row">10.128.0.250/24: Access Point im Obergeschoss</span>
            <span class="row">10.128.0.251/24: Access Point im Erdgeschoss</span>
            <span class="row">10.128.0.253/24 und 10.128.40.253/24: Hauptserver</span>
            <span class="row">10.128.40.252/24: Telefonadapter</span>
          </fieldset>

          <fieldset>
            <legend>Dynamisch vergebene Adressen</legend>

            <h4>Management</h4>
            <table id="dhcpv4-clients-management">
              <th>
                <td>Client-ID (hexadezimal, ohne Doppelpunkttrennung)</td>
                <td>Rechnername</td>
                <td>Ablaufzeitpunkt</td>
              </th>
            </table>

            <div class="row">
              <output id="dhcpv4-status-management">Warte auf Initialisierung...</output>
            </div>

            <h4>Trusted (WLAN-Kabel)</h4>
            <table id="dhcpv4-clients-trusted">
              <th>
                <td>Client-ID (hexadezimal, ohne Doppelpunkttrennung)</td>
                <td>Rechnername</td>
                <td>Ablaufzeitpunkt</td>
              </th>
            </table>

            <div class="row">
              <output id="dhcpv4-status-trusted">Warte auf Initialisierung...</output>
            </div>

            <h4>Untrusted (Internet)</h4>
            <table id="dhcpv4-clients-untrusted">
              <th>
                <td>Client-ID (hexadezimal, ohne Doppelpunkttrennung)</td>
                <td>Rechnername</td>
                <td>Ablaufzeitpunkt</td>
              </th>
            </table>

            <div class="row">
              <output id="dhcpv4-status-untrusted">Warte auf Initialisierung...</output>
            </div>

            <h4>Isolated (Schwefelhexafluorid)</h4>
            <table id="dhcpv4-clients-isolated">
              <th>
                <td>Client-ID (hexadezimal, ohne Doppelpunkttrennung)</td>
                <td>Rechnername</td>
                <td>Ablaufzeitpunkt</td>
              </th>
            </table>

            <div class="row">
              <output id="dhcpv4-status-isolated">Warte auf Initialisierung...</output>
            </div>

            <h4>Exposed (Neuland)</h4>
            <table id="dhcpv4-clients-exposed">
              <th>
                <td>Client-ID (hexadezimal, ohne Doppelpunkttrennung)</td>
                <td>Rechnername</td>
                <td>Ablaufzeitpunkt</td>
              </th>
            </table>

            <div class="row">
              <output id="dhcpv4-status-exposed">Warte auf Initialisierung...</output>
            </div>

            <br />

            <p>Information: Abgelaufene Leases werden erst bei der n√§chsten
            Anfrage an den Server aus der Liste entfernt. Dies kann Minuten
            oder Wochen dauern.</p>

            <p>Information: Die Client-ID wird nicht von allen Ger√§ten
            mitgesendet. Insbesondere IoT-Ger√§te teilen dem Server oft keinen
            eigenen Wert mit. In diesen F√§llen erzeugt der Server automatisch
            eine Client-ID nach dem Muster 01:HARDWAREADRESSE.</p>

            <p>Information: Der Rechnername wird nicht von allen Ger√§ten
            mitgesendet. Insbesondere iOS-Ger√§te verschleiern ihn oft. Das
            Deaktivieren der Option "Private WLAN-Adresse verwenden" in den
            Einstellungen der WLAN-Verbindung (Info-I-Symbol) kann Abhilfe
            schaffen. Unbekannte Rechnernamen beeintr√§chtigen die
            Internetverbindung nicht, erschweren aber die Identifikation der
            Ger√§te (Client-ID und Diagnoseprotokoll des DNS-Forwarders k√∂nnen
            sie weiterhin deanonymisieren).</p>
          </fieldset>
        </fieldset>
      </form>

      <br />

      <form id="slaac-form">
        <fieldset>
          <legend>SLAAC-Server</legend>

          <span class="row" id="slaac-flags">Flags: On-Link, Autonomous (A)</span>
          <span class="row" id="slaac-ralft">Standardgateway-G√ºltigkeitsdauer: 1800 Sekunden</span>
          <span class="row" id="slaac-preflft">Pr√§fix-Verwendungsdauer: 1500 Sekunden</span>
          <span class="row" id="slaac-validlft">Pr√§fix-G√ºltigkeitsdauer: 1800 Sekunden</span>
          <span class="row" id="slaac-dnslft">DNS-Server-G√ºltigkeitsdauer: 1800 Sekunden</span>

          <p>Information: IPv6-Adressen werden per SLAAC zugewiesen, DHCPv6 im
          Heimnetz wird nicht unterst√ºtzt. Das bedeutet, dass der Router auf
          jedem Netzwerk periodisch sowie auf Anfrage beitretender Ger√§te das
          jeweilige √∂ffentliche Pr√§fix und weitere Parameter verbreitet (ULA
          bzw. eindeutige lokale IPv6-Adressen werden nicht unterst√ºtzt). Die
          Ger√§te w√§hlen die zweite Adressh√§lfte selbst und stellen sicher, dass
          diese nicht mit existierenden Adressen anderer Rechner kollidieren.
          Daher ist dem Router nicht bekannt, welche Adressen existieren,
          weshalb sie hier nicht aufgelistet werden k√∂nnen. Scans mit anderen
          Netzwerk-Dienstprogrammen zusammen mit den Diagnoseprotokollen k√∂nnen
          dieses Problem l√∂sen. Die beste Methode w√§re ein DHCPv6-Server, der
          aber aufgrund des h√∂heren Aufwands und der fehlenden Kompatibilit√§t
          mit Android-Ger√§ten nicht vorhanden ist.  Zudem k√∂nnen Ger√§te
          beliebig viele Adressen beanspruchen, was aufgrund der Gr√∂√üe des
          Adressraums (2‚Å∂‚Å¥) nicht problematisch, sondern insbesondere auf
          Servern sogar hilfreich ist. Die Pr√§fixableitung f√ºr die
          verschiedenen Subnetze ist unter dem Punkt "Virtuelle Netzwerke"
          beschrieben.</p>

          <p>Statische Adressen bzw. Suffixe k√∂nnen auf den Ger√§ten selbst
          eingestellt werden. Auch andere Parameter k√∂nnen dort √ºberschrieben
          werden. Pr√§fixbezogenes dynamisches DNS ist unter dem Men√ºpunkt
          "Dynamisches DNS (INWX)" konfigurierbar.</p>
        </fieldset>
      </form>

      <br />

      <form id="dns-form">
        <fieldset>
          <legend>DNS</legend>

          <span class="row" id="dns-primary-us">Prim√§rer DNS-Server: 2620:fe::fe (Quad9)</span>
          <span class="row" id="dns-secondary-us">Sekund√§rer DNS-Server: 9.9.9.9 (Quad9)</span>
          <span class="row" id="dns-primary-ds">Lokaler DNS-Server (IPv4): 10.128.SUBNETZ.254</span>
          <span class="row" id="dns-secondary-ds">Lokaler DNS-Server (IPv6): fe80::1</span>

          <br />

          <div class="row">
            <button id="dns-kill">üîÑ Forwarder-Neustart</button>
          </div>

          <p>Information: Anfragen lokaler Ger√§te werden an die oberen beiden
          DNS-Server weitergeleitet (zuerst an den prim√§ren Server, bei Fehlern
          nach max. 3 Sekunden an den sekund√§ren Server). Auf lokalen Ger√§ten
          wird automatisch dieser Router als DNS-Server eingestellt. Sollte die
          manuelle Konfiguration eines Ger√§ts n√∂tig sein, nutzen Sie die
          unteren beiden Werte. F√ºr IPv4 ist SUBNETZ je nach Netzwerkname mit
          folgender Zahl zu ersetzen: 10 f√ºr "WLAN-Kabel", 20 f√ºr "Internet",
          30 f√ºr "Schwefelhexafluorid", 40 f√ºr "Neuland" und 0 f√ºr direkte
          Kabelverbindungen ohne VLAN (s. "Virtuelle Netzwerke"). Ein Neustart
          des DNS-Forwarders dauert ca. 30 Sekunden. W√§hrend dieser Zeit k√∂nnen
          abgehende Verbindungen ins Internet fehlschlagen und bestehende
          Verbindungen unterbrochen werden. M√∂glicherweise muss danach der
          Telefonadapter ebenfalls neu gestartet werden, um den Telefoniedienst
          wiederherzustellen (falls beeintr√§chtigt). Im Normalfall sind
          derartige Neustarts nicht n√∂tig, mit Ausnahme von √Ñnderungen an der
          lokalen Domain.</p>

          <label for="dns-domain" form="dns-form">Lokale Domain:</label>
          <div class="row">
            <input id="dns-domain" placeholder="z.B. local, lan, home etc." />
          </div>

          <br />

          <div class="row">
            <button id="dns-unset">Domain entfernen</button>
            <button id="dns-submit" type="submit">Domain √§ndern</button>
          </div>

          <p id="dns-status">Warte auf Initialisierung...</p>

          <p>Information: Die lokale Domain ist ein optionales, empfohlenes
          Suffix, unter dem Ger√§te in den lokalen Netzwerken erreichbar sind.
          Beispielsweise w√§re ein Ger√§t mit dem Namen "Arbeitsrechner" bei der
          lokalen Domain "example.com" sowohl unter "Arbeitsrechner" als auch
          unter "Arbeitsrechner.example.com" erreichbar. Diese Erreichbarkeit
          gilt nicht f√ºr Zugriffe aus dem √∂ffentlichen Internet. Die lokale
          Domain sollte f√ºr dieses Netzwerk nur ver√§ndert werden, wenn dies
          wirklich n√∂tig ist.</p>
        </fieldset>
      </form>
    </div>
  </body>
</html>
