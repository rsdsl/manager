<!doctype html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="styles.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VPN - RSDSL Verwaltungswerkzeug</title>
    <script type="module" src="/dashboard.js" defer></script>
    <script type="module" src="/vpn.js" defer></script>
  </head>

  <body>
    <div class="container">
      <h1>VPN</h1>

      <div class="row">
        <form id="dashboard-form">
          <button id="dashboard-submit" type="submit">‚Ü© Zur√ºck zur √úbersicht</button>
        </form>

        <form id="wan-open-form">
          <button id="wan-open-submit" type="submit">Einwahl und Zugangsdaten</button>
        </form>

        <form id="lan-open-form">
          <button id="lan-open-submit" type="submit">LAN</button>
        </form>

        <form id="vpn-open-form">
          <button id="vpn-open-submit" type="submit">VPN</button>
        </form>

        <form id="log-open-form">
          <button id="log-open-submit" type="submit">Diagnoseprotokolle</button>
        </form>

        <form id="sys-open-form">
          <button id="sys-open-submit" type="submit">System</button>
        </form>

        <form id="disconnect-form">
          <button id="disconnect-submit" type="submit">üö™ Abmelden</button>
        </form>
      </div>

      <br />

      <form id="profile-form">
        <fieldset>
          <legend>Clientseitige Konfiguration</legend>

          <p>
            1. WireGuard installieren: <a
            href="https://www.wireguard.com/install/"
            target="_blank">https://www.wireguard.com/install/</a>

            <br />

            2. Tunnel hinzuf√ºgen / Add a tunnel / +

            <br />

            3. Ger√§tenummer ermitteln: Beliebige Zahl zwischen 100 und 239 w√§hlen, die nicht bereits f√ºr ein anderes Ger√§t verwendet wird

            <br />

            4. Daten selbst eingeben / Create from scratch

            <br />

            5. "Generate keypair" dr√ºcken und privaten Schl√ºssel / Private key in die Zwischenablage kopieren

            <br />

            6. Ger√§tedaten eintragen

            <br /><br />

            - Name: wg0 (beliebig w√§hlbar)<br />
            - Privater Schl√ºssel / Private key: Mit weiterer Bet√§tigung von "Generate keypair" automatisch erzeugen lassen<br />
            - √ñffentlicher Schl√ºssel / Public key: Wird ebenfalls von "Generate keypair" erzeugt<br />
            - Adressen / Addresses: 10.128.50.GER√ÑTENUMMER/32, fd0b:9272:534e:6::GER√ÑTENUMMER/128 (Achtung: F√ºr Firewallausnahme stattdessen 10.128.60.GER√ÑTENUMMER/32, fd0b:9272:534e:7::GER√ÑTENUMMER/128 verwenden)<br />
            - Listen port: Keine Angabe (automatisch)<br />
            - MTU: Keine Angabe (automatisch)<br />
            - DNS-Server / DNS servers: 10.128.50.254, fd0b:9272:534e:6::1 (Achtung: F√ºr Firewallausnahme stattdessen 10.128.60.254, fd0b:9272:534e:7::1 verwenden)<br />

            <br />

            7. Ger√§t hinzuf√ºgen / Add peer

            <br /><br />

            - √ñffentlicher Schl√ºssel / Public key: <span id="profile-pubkey">Siehe Diagnoseprotokoll</span><br />
            - Symmetrischer Schl√ºssel / Preshared key: Aus Zwischenablage einf√ºgen<br />
            - Endpunkt / Endpoint: rtr.himbeerserver.de:51820 (Achtung: F√ºr Firewallausnahme stattdessen rtr.himbeerserver.de:51821 verwenden)<br />
            - Erlaubte IP-Adressen / Allowed IPs: 0.0.0.0/0, ::/0<br />
            - Private IP-Adressen ignorieren / Exclude private IPs: Nein (bei Zugriff aus dem √∂ffentlichen Internet egal, bei Zugriff aus dem Heimnetz relevant)<br />
            - Keep-Alive / Persistent keepalive: Keine Angabe (deaktiviert), kann ggf. auf 25 gesetzt werden<br />

            <br />

            8. Speichern
          </p>
        </fieldset>
      </form>

      <form id="server-form">
        <fieldset>
          <legend>Server</legend>

          <div class="row">
            <label for="server-pubkey">√ñffentlicher Schl√ºssel / Public key:</label>
            <span id="server-pubkey">Siehe Diagnoseprotokoll</span>
          </div>

          <br />

          <div class="row">
            <button id="server-restart">üîÑ VPN-Server-Neustart</button>
          </div>

          <p>Information: Ein Neustart des VPN-Servers dauert ca. 30 Sekunden.
          Eventuell gehen dabei bestehende VPN-Verbindungen verloren. Bei
          Fehlkonfiguration ist mit gro√üer Wahrscheinlichkeit kein
          VPN-Verbindungsaufbau mehr m√∂glich.</p> 
        </fieldset>
      </form>

      <br />

      <form id="client-form">
        <fieldset>
          <legend>Clients</legend>

          <table id="client-clients">
            <th>
              <td>√ñffentlicher Schl√ºssel / Public key</td>
              <td>Symmetrischer Schl√ºssel / Preshared key</td>
              <td>Erlaubte IP-Adressen / Allowed IPs</td>
            </th>
          </table>

          <div class="row">
            <output id="client-status">Warte auf Initialisierung...</output>
          </div>

          <p>Information: Es ist zul√§ssig (aber nicht sinnvoll), mehrere
          Clients mit dem gleichen Namen zu erstellen. Beim L√∂schen werden alle
          Clients mit passendem Namen entfernt, unabh√§ngig davon, welcher
          Client tats√§chlich gel√∂scht werden sollte.</p>
        </fieldset>
      </form>

      <br />

      <form id="add-form">
        <fieldset>
          <legend>Client hinzuf√ºgen</legend>

          <label for="add-name" form="add-form">Name:</label>
          <div class="row">
            <input id="add-name" />
          </div>

          <br />

          <label for="add-pubkey" form="add-form">√ñffentlicher Schl√ºssel / Public key:</label>
          <div class="row">
            <input id="add-pubkey" />
          </div>

          <br />

          <label for="add-psk" form="add-form">Symmetrischer Schl√ºssel / Preshared key:</label>
          <div class="row">
            <input id="add-psk" type="password" />
          </div>
          <br />
          <div class="row">
            <button id="add-show">üîí Symmetrischen Schl√ºssel ein-/ausblenden</button>
          </div>

          <br />

          <label for="add-allowedips" form="add-form">Erlaubte IP-Adressen / Allowed IPs:</label>
          <div class="row">
            <input id="add-allowedips" placeholder="z.B. 10.128.50.100/32 fd0b:9272:534e:6::100/128" />
          </div>

          <br />

          <div class="row">
            <button id="add-submit" type="submit">Client hinzuf√ºgen</button>
          </div>

          <p id="add-status"></p>

          <p>Information: Es ist zul√§ssig (aber nicht sinnvoll), mehrere
          Clients mit dem gleichen Namen zu erstellen. Beim L√∂schen wird der
          erste Client mit passendem Namen entfernt, unabh√§ngig davon, welcher
          Client tats√§chlich gel√∂scht werden sollte.</p>
        </fieldset>
      </form>
    </div>
  </body>
</html>
